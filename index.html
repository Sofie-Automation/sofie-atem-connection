<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>atem-connection</title><meta name="description" content="Documentation for atem-connection"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">atem-connection</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>atem-connection </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#sofie-the-modern-tv-news-studio-automation-system-atem-connection-library" id="sofie-the-modern-tv-news-studio-automation-system-atem-connection-library" style="color: inherit; text-decoration: none;">
  <h1>Sofie: The Modern TV News Studio Automation System (ATEM connection library)</h1>
</a>
<p><a href="https://github.com/nrkno/sofie-atem-connection/actions/workflows/node.yaml"><img src="https://github.com/nrkno/sofie-atem-connection/actions/workflows/node.yaml/badge.svg" alt="Node CI"></a>
<a href="https://codecov.io/gh/nrkno/sofie-atem-connection/"><img src="https://codecov.io/gh/nrkno/sofie-atem-connection/branch/master/graph/badge.svg" alt="codecov"></a>
<a href="https://www.npmjs.com/package/atem-connection"><img src="https://img.shields.io/npm/v/atem-connection" alt="npm"></a></p>
<p>This library is used in the <a href="https://github.com/nrkno/Sofie-TV-automation/"><strong>Sofie</strong> TV News Studio Automation System</a> for connecting to Blackmagic Design ATEM devices.</p>

<a href="#device-support" id="device-support" style="color: inherit; text-decoration: none;">
  <h2>Device support</h2>
</a>
<table>
<thead>
<tr>
<th>Version</th>
<th>Level of Support</th>
</tr>
</thead>
<tbody><tr>
<td>v8.0 - v8.6</td>
<td>Primary focus. Target for new features</td>
</tr>
<tr>
<td>v7.2</td>
<td>Previous focus, should still work well</td>
</tr>
<tr>
<td>v7.3 - v7.5.2</td>
<td>Community tested, we may accept PRs but will not be testing these</td>
</tr>
</tbody></table>
<p>Due to the nature of the ATEM firmware and its tendency to break things, it is likely that new firmwares will require updates to the library to be fully supported.
Additionally any newly unimplemented functionality will generally only be written and tested for the latest firmware, even if it was added in an older firmware.</p>
<p>We have no intention of dropping support for older firmwares, but we may do at some point. If we do this will be done in a major version bump, and will only be for significantly older firmware.</p>
<p>It is tested on a variety of models spanning every generation, and the aim is to provide support for every model.</p>
<p>Note: USB control of devices is not supported by this library.</p>

<a href="#technology-highlights" id="technology-highlights" style="color: inherit; text-decoration: none;">
  <h2>Technology highlights</h2>
</a>
<ul>
<li>Typescript</li>
<li>Jest</li>
<li>standard-version</li>
<li>codecov</li>
</ul>

<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
  <h2>Installation</h2>
</a>
<p>For usage by library consumers installation is as easy as:</p>
<pre><code class="language-sh"><span class="hl-0">yarn add atem-connection</span>
</code></pre>
<p>For library developers installation steps are as following:</p>
<pre><code class="language-sh"><span class="hl-0">git clone https://github.com/nrkno/tv-automation-atem-connection</span><br/><span class="hl-0">yarn</span><br/><span class="hl-0">yarn build</span>
</code></pre>
<p>We welcome any contributions. Please read <a href=".github/CONTRIBUTING.md">our guide</a> on how to add new commands before raising a PR.</p>

<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h2>Usage</h2>
</a>
<pre><code class="language-javascript"><span class="hl-1">const</span><span class="hl-0"> { </span><span class="hl-2">Atem</span><span class="hl-0"> } = </span><span class="hl-3">require</span><span class="hl-0">(</span><span class="hl-4">&#39;atem-connection&#39;</span><span class="hl-0">)</span><br/><span class="hl-1">const</span><span class="hl-0"> </span><span class="hl-2">myAtem</span><span class="hl-0"> = </span><span class="hl-1">new</span><span class="hl-0"> </span><span class="hl-3">Atem</span><span class="hl-0">()</span><br/><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">on</span><span class="hl-0">(</span><span class="hl-4">&#39;info&#39;</span><span class="hl-0">, </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-5">log</span><span class="hl-0">)</span><br/><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">on</span><span class="hl-0">(</span><span class="hl-4">&#39;error&#39;</span><span class="hl-0">, </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-5">error</span><span class="hl-0">)</span><br/><br/><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">connect</span><span class="hl-0">(</span><span class="hl-4">&#39;192.168.168.240&#39;</span><span class="hl-0">)</span><br/><br/><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">on</span><span class="hl-0">(</span><span class="hl-4">&#39;connected&#39;</span><span class="hl-0">, () </span><span class="hl-1">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">changeProgramInput</span><span class="hl-0">(</span><span class="hl-6">3</span><span class="hl-0">).</span><span class="hl-3">then</span><span class="hl-0">(() </span><span class="hl-1">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-7">// Fired once the atem has acknowledged the command</span><br/><span class="hl-0">        </span><span class="hl-7">// Note: the state likely hasnt updated yet, but will follow shortly</span><br/><span class="hl-0">        </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-3">log</span><span class="hl-0">(</span><span class="hl-4">&#39;Program input set&#39;</span><span class="hl-0">)</span><br/><span class="hl-0">    })</span><br/><span class="hl-0">    </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-3">log</span><span class="hl-0">(</span><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-5">state</span><span class="hl-0">)</span><br/><span class="hl-0">})</span><br/><br/><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">on</span><span class="hl-0">(</span><span class="hl-4">&#39;stateChanged&#39;</span><span class="hl-0">, (</span><span class="hl-5">state</span><span class="hl-0">, </span><span class="hl-5">pathToChange</span><span class="hl-0">) </span><span class="hl-1">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-3">log</span><span class="hl-0">(</span><span class="hl-5">state</span><span class="hl-0">) </span><span class="hl-7">// catch the ATEM state.</span><br/><span class="hl-0">})</span>
</code></pre>

<a href="#documentation" id="documentation" style="color: inherit; text-decoration: none;">
  <h3>Documentation</h3>
</a>
<p>You can find the generated type docs <a href="https://nrkno.github.io/sofie-atem-connection/">here</a>.</p>

<a href="#events" id="events" style="color: inherit; text-decoration: none;">
  <h3>Events</h3>
</a>
<ul>
<li><p><code>error</code>
This event will be fired when an error occurs in the connection. Node requires you to handle these errors, or your application will quit.</p>
</li>
<li><p><code>info</code>
This event will be fired when the connection provides some logging information.</p>
</li>
<li><p><code>debug</code>
This event is not useful for most users. It will emit some messages useful to figure out why some data useful mostly to library developers.</p>
</li>
<li><p><code>connected</code>
This event will be fired once we have connected with the ATEM.</p>
</li>
<li><p><code>disconnected</code>
Whenever the connection to the ATEM fails and does not recover within 5 seconds this is called.</p>
</li>
<li><p><code>stateChanged(state, path)</code>
Whenever a packet from the ATEM is received that changes the state, this event will be fired.
The path parameter is a path into the state that represents the change, to allow for filtering of events. eg video.mixEffects.0.programInput</p>
</li>
<li><p><code>receivedCommand(command)</code>
Whenever a packet from the ATEM is received that contains a command, this event will be fired.
This should not be relied on in most usage, as the commands can and will have breaking changes in patch releases. This event is needed for some use cases, so if this is used you should likely pin the version down to a specific patch release to ensure nothing breaks.</p>
</li>
</ul>

<a href="#debug" id="debug" style="color: inherit; text-decoration: none;">
  <h2>Debug</h2>
</a>
<p>Set <code>debugBuffers=true</code> config option in order to see raw packets. This is especially useful for library developers.</p>
<pre><code class="language-javascript"><span class="hl-1">const</span><span class="hl-0"> </span><span class="hl-2">myAtem</span><span class="hl-0"> = </span><span class="hl-1">new</span><span class="hl-0"> </span><span class="hl-3">Atem</span><span class="hl-0">({ </span><span class="hl-5">debugBuffers:</span><span class="hl-0"> </span><span class="hl-1">true</span><span class="hl-0"> })</span><br/><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">on</span><span class="hl-0">(</span><span class="hl-4">&#39;info&#39;</span><span class="hl-0">, </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-5">log</span><span class="hl-0">)</span><br/><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">on</span><span class="hl-0">(</span><span class="hl-4">&#39;debug&#39;</span><span class="hl-0">, </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-5">log</span><span class="hl-0">)</span><br/><span class="hl-5">myAtem</span><span class="hl-0">.</span><span class="hl-3">on</span><span class="hl-0">(</span><span class="hl-4">&#39;error&#39;</span><span class="hl-0">, </span><span class="hl-5">console</span><span class="hl-0">.</span><span class="hl-5">error</span><span class="hl-0">)</span>
</code></pre>
<pre><code class="language-sh"><span class="hl-0">SEND &lt;Buffer 10 14 53 ab 00 00 00 00 00 3a 00 00 01 00 00 00 00 00 00 00&gt;</span><br/><span class="hl-0">SEND &lt;Buffer 80 0c 53 ab 00 00 00 00 00 03 00 00&gt;</span><br/><span class="hl-0">SEND &lt;Buffer 80 0c 53 ab 00 00 00 00 00 03 00 00&gt;</span><br/><span class="hl-0">SEND &lt;Buffer 80 0c 80 0f 00 01 00 00 00 41 00 00&gt;</span><br/><span class="hl-0">RECV &lt;Buffer 00 0c 90 60 5f 76 65 72 00 02 00 10&gt;...</span>
</code></pre>

<a href="#test" id="test" style="color: inherit; text-decoration: none;">
  <h2>Test</h2>
</a>
<p>This module run tests with jest.</p>
<pre><code class="language-sh"><span class="hl-0">$ yarn unit</span>
</code></pre>
<p>There is a suite of generated serialization tests, using <a href="https://github.com/LibAtem/atem-connection-test-generator">atem-connection-test-generator</a> as the <a href="https://github.com/LibAtem">LibAtem</a> project has tests to verify its serialization against the Blackmagic Atem SDK</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li><li class=" tsd-kind-namespace"><a href="modules/AtemStateUtil.html">Atem<wbr/>State<wbr/>Util</a></li><li class=" tsd-kind-namespace"><a href="modules/AudioState.html">Audio<wbr/>State</a></li><li class=" tsd-kind-namespace"><a href="modules/Commands.html">Commands</a></li><li class=" tsd-kind-namespace"><a href="modules/DisplayClock.html">Display<wbr/>Clock</a></li><li class=" tsd-kind-namespace"><a href="modules/Enums.html">Enums</a></li><li class=" tsd-kind-namespace"><a href="modules/Fairlight.html">Fairlight</a></li><li class=" tsd-kind-namespace"><a href="modules/InfoState.html">Info<wbr/>State</a></li><li class=" tsd-kind-namespace"><a href="modules/InputState.html">Input<wbr/>State</a></li><li class=" tsd-kind-namespace"><a href="modules/MacroState.html">Macro<wbr/>State</a></li><li class=" tsd-kind-namespace"><a href="modules/MediaState.html">Media<wbr/>State</a></li><li class=" tsd-kind-namespace"><a href="modules/Recording.html">Recording</a></li><li class=" tsd-kind-namespace"><a href="modules/SettingsState.html">Settings<wbr/>State</a></li><li class=" tsd-kind-namespace"><a href="modules/Streaming.html">Streaming</a></li><li class=" tsd-kind-namespace"><a href="modules/Util.html">Util</a></li><li class=" tsd-kind-namespace"><a href="modules/VideoState.html">Video<wbr/>State</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-reference"><a href="modules.html#ClassicAudio" class="tsd-kind-icon">Classic<wbr/>Audio</a></li><li class="tsd-kind-reference"><a href="modules.html#Info" class="tsd-kind-icon">Info</a></li><li class="tsd-kind-reference"><a href="modules.html#Input" class="tsd-kind-icon">Input</a></li><li class="tsd-kind-reference"><a href="modules.html#Macro" class="tsd-kind-icon">Macro</a></li><li class="tsd-kind-reference"><a href="modules.html#Media" class="tsd-kind-icon">Media</a></li><li class="tsd-kind-reference"><a href="modules.html#Settings" class="tsd-kind-icon">Settings</a></li><li class="tsd-kind-reference"><a href="modules.html#Video" class="tsd-kind-icon">Video</a></li><li class="tsd-kind-enum"><a href="enums/AtemConnectionStatus.html" class="tsd-kind-icon">Atem<wbr/>Connection<wbr/>Status</a></li><li class="tsd-kind-class"><a href="classes/Atem.html" class="tsd-kind-icon">Atem</a></li><li class="tsd-kind-class"><a href="classes/BasicAtem.html" class="tsd-kind-icon">Basic<wbr/>Atem</a></li><li class="tsd-kind-class"><a href="classes/InvalidIdError.html" class="tsd-kind-icon">Invalid<wbr/>Id<wbr/>Error</a></li><li class="tsd-kind-interface"><a href="interfaces/AtemOptions.html" class="tsd-kind-icon">Atem<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/AtemState.html" class="tsd-kind-icon">Atem<wbr/>State</a></li><li class="tsd-kind-interface"><a href="interfaces/ColorGeneratorState.html" class="tsd-kind-icon">Color<wbr/>Generator<wbr/>State</a></li><li class="tsd-kind-type-alias"><a href="modules.html#AtemEvents" class="tsd-kind-icon">Atem<wbr/>Events</a></li><li class="tsd-kind-variable"><a href="modules.html#DEFAULT_PORT" class="tsd-kind-icon">DEFAULT_<wbr/>PORT</a></li><li class="tsd-kind-function"><a href="modules.html#listVisibleInputs" class="tsd-kind-icon">list<wbr/>Visible<wbr/>Inputs</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>